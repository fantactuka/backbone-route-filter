(function(t,i){i.extend(t.Router.prototype,{route:function(r,e,s){return i.isRegExp(r)||(r=this._routeToRegExp(r)),s||(s=this[e]),t.history.route(r,i.bind(function(i){var o=this._extractParameters(r,i);this._runFilters(this.before,i,o,!0)&&(s&&s.apply(this,o),this.trigger.apply(this,["route:"+e].concat(o)),this.trigger("route",e,o),t.history.trigger("route",this,e,o),this._runFilters(this.after,i,o,!1))},this)),this},_runFilters:function(t,r,e,s){return i[s?"every":"each"](t,function(t,s){return s=i.isRegExp(s)?s:this._routeToRegExp(s),s.test(r)?(t=i.isFunction(t)?t:this[t],t.apply(this,[r,e])!==!1):!0},this)}})})(Backbone,_);